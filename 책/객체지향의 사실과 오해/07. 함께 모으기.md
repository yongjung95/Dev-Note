# 7장 함께 모으기

## 개요
- 객체지향 설계 안에 존해나느 세 가지 상호 연관된 관점
  - `개념 관점`
    - `설계는 도메인 안에 존재하는 개념과 개념 사이의 관계를 표현`한다.
      - `도메인이란 사용자들이 관심을 가지고 있는 특정 분야나 주제`를 말하며 `소프트웨어는 도메인에 존재하는 문제를 해결하기 위해 개발`된다.
    - 따라서 `실제 도메인의 규칙과 제약을 최대한 유사하게 반영하는 것이 핵심`이다.
  - `명세 관점`
    - 명세 관점에 이르면 `사용자의 영역인 도메인을 벗어나 개발자의 영역인 소프트웨어로 초점`이 옮겨진다.
    - 명세 관점은 `도메인의 개념이 아니라 실제로 소프트웨어 안에서 살아 숨쉬는 객체들의 책임에 초점`을 맞추게 된다.
      - 즉, `객체의 인터페이스를 바라보게 된다.`
    - 인터페이스와 구현을 분리하는 것은 `훌륭한 객체지향 설계를 낳는 가장 기본적인 원칙이라는 점을 기억`하라.
      - `구현이 아니라 인터페이스에 대해 프로그래밍하라`를 따르는 것은 명세 관점과 구현 관점을 명확하게 분리하는 것에서부터 시작된다.
  - `구현 관점`
    - 구현 관점의 초점은 `객체들이 책임을 수행하는 데 필요한 동작하는 코드를 작성하는 것`이다.
      - 따라서 프로그래머는 `객체의 책임을 '어떻게' 수행할 것인가에 초점을 맞추며 인터페이스를 구현하는 데 필요한 속성과 메서드를 클래스에 추가`한다.
  - 개념 관점, 명세 관점, 구현 관점은 `동일한 클래스를 세 가지 다른 방향에서 바라보는 것을 의미`한다.
    - 클래스는 세 가지 관점이라는 안경을 통해 설계와 관련된 다양한 측면을 드러낼 수 있다.
      - `클래스가 은유하는 개념은 도메인 관점을 반영`한다.
      - `클래스의 공용 인터페이스는 명세 관점을 반영`한다.
      - `클래스의 속성과 메서드는 구현 관점을 반영`한다.
    - 클래스는 `세 가지 관점을 모두 수용할 수 있도록 개념, 인터페이스, 구현을 함께 드러내야` 한다.
      - 동시에 `코드 안에서 세 가지 관점을 쉽게 식별할 수 있도록 깔끔하게 분리`해야 한다.
  - 협력에 참여하기 위해 `객체가 수신해야 하는 메시지를 결정하고 메시지들이 모여 객체의 인터페이스를 구성하는 점을 기억`하라.
    - 따라서 협력 안에서 메시지를 선택하고 메시지를 수신할 객체를 선택하는 것은 `객체의 인터페이스, 즉 명세 관점에서 객체를 바라보는 것`이다.


## 커피 전문점 도메인
### 커피 점문점이라는 세상
- 인간의 두뇌는 세상을 이해하기 위해 객체를 직접적으로 다룰 수 있는 만큼 휴율적이지 못하다.
  - 우리가 할 수 있는 일은 `동적인 객체를 정적인 타입으로 추상화해서 복잡성을 낮추는 것`이다.
  - 타입은 `분류를 위해 사용된다는 것을 기억`하라.
  - `상태와 무관하게 동일하게 행동할 수 있는 객체들은 동일한 타입의 인스턴스로 분류`할 수 있다.
- `소프트웨어가 대상으로 하는 영역인 도메인을 단순화해서 표현한 모델을 도메인 모델`이라고 한다.


## 설계하고 구현하기
### 커피를 주문하기 위한 협력 찾기
- 객체지향의 첫 번째 목표는 `훌륭한 객체를 설계하는 것이 아니라 훌륭한 협력을 설계하는 것이라는 점`을 잊지 말자.
  - 훌륭한 객체는 `훌륭한 협력을 설계할 때만 얻을 수 있다.`
- 협력을 설계할 때는 `객체가 메시지를 선택하는 것이 아니라 메시지가 객체를 선택`하게 해야 한다.
  - `메시지를 먼저 선택하고 그 후에 메시지를 수신하기에 적절한 객체를 선택해야 한다는 것을 의미`한다.
- 메시지를 처리할 객체를 찾고 있다면 먼저 `도메인 모델 안에 책임을 수행하기에 적절한 타입이 존재하는지 살펴보라.`
  - 적절한 타입을 발견했다면 `책임을 수행할 객체를 그 타입의 인스턴스`로 만들어라.
  - 현실 속의 객체와 소프트웨어 객체가 완전히 동일할 수는 없겠지만 적어도 `소프트웨어 객체에게 현실 객체와 유사한 이름을 붙여 놓으면 유사성을 통해 소프트웨어 객체가 수행해야 하는 책임과 상태를 좀 더 쉽게 유추`할 수 있다.

### 인터페이스 정리하기
- `객체가 수신한 메시지가 객체의 인터페이스를 결정한다는 사실을 기억`하라.
  - `메시지가 객체를 선택했고, 선택된 객체는 메시지를 자신의 인터페이스`로 받아들인다.
- 각 객체의 협력이라는 문맥에서 뗴어내어 수신 가능한 메시지만 추려내면 객체의 인터페이스가 된다.
  - 객체가 `어떤 메시지를 수신할 수 있다는 것은 그 객체의 인터페이스 안에 메시지에 해당하는 오퍼레이션이 존재한다는 것을 의미`한다.
- 객체들의 협력은 `실행 시간에 컴퓨터 안에서 일어나는 상황을 동적으로 묘사한 모델`이다.
  - 실제로 소프트웨어의 구현은 동적인 객체가 아닌 정적인 타입을 이용해 이뤄진다.
  - 따라서 `객체들을 포괄하는 타입을 정의한 후 식별된 오퍼레이션을 타입의 인터페이스에 추가`해야 한다.
- 객체의 타입을 구현하는 일반적인 방법은 `클래스를 이용하는 것`이다.
  - `협력을 통해 식별된 타입의 오퍼레이션은 외부에서 접근 가능한 공용 인터페이스의 일부라는 사실을 기억`하라.
  - 따라서 `인터페이스에 포함된 오퍼레이션 역시 외부에서 접근 가능하도록 공용(public)으로 선언돼 있어야 한다.

### 구현하기
- `객체가 다른 객체에게 메시지를 전송하기 위해서는 먼저 객체에 대한 참조`를 얻어야 한다.
- 참고
  - 구현하지 않고 머릿속으로만 구상한 설계는 `코드로 구현하는 단계에서 대부분 변경`된다.
    - `협력을 구상하는 단계에 너무 오랜 시간을 쏟지 말고 최대한 빨리 코드를 구현해서 설계에 이상이 없는지, 설계가 구현 가능한지를 판단`해야 한다.
    - `코드를 통한 피드백 없이는 깔끔한 설계를 얻을 수 없다.`
    - 인터페이스를 통해 `실제로 상호작용을 해보지 않은 채 인터페이스의 모습을 정확하게 예측하는 것은 불가능`에 가깝다.
  - 객체에게 책임을 할당하고 인터페이스를 결정할 때는 `가급적 객체 내부의 구현에 대한 어떤 가정도 하지 말아야` 한다.
    - 객체가 `어떤 책임을 수행해야 하는지를 결정한 후에야 책임을 수행하는 데 필요한 객체의 속성을 결정`하라.
    - 이것이 객체의 구현 세부 사항을 객체의 공용 인터페이스에 노출시키지 않고 `인터페이스와 구현을 깔끔하게 분리할 수 있는 기본적이 방법`이다.


## 코드와 세가지 관점
- 개념 관점
  - 소프트웨어 클래스가 `도메인 개념의 특성을 최대한 수용하면 변경을 관리하기 쉽고 유지보수성을 향상`시킬 수 있다.
    - 소프트웨어 클래스와 도메인 클래스 사이의 간격이 좁으면 좁을수록 `기능을 변경하기 위해 뒤적거려야 하는 코드의 양도 점점 줄어든다.`
- 명세 관점
  - 명세 관점은 `클래스의 인터페이스를 바라본다.`
  - 클래스의 pulbic 메서드는 `다른 클래스가 협력할 수 있는 공용 인터페이스`를 드러낸다.
    - 공용 인터페이스는 `외부의 객체가 해당 객체에 접근할 수 있는 유일한 부분`이다.
  - 인터페이스를 `수정하면 해당 객체와 협력하는 모든 객체에게 영향`을 미칠 수밖에 없다.
    - 최대한 변화에 안정적인 인터페이스를 만들기 위해서는 `인터페이스를 통해 구현과 관련된 세부 사항이 드러나지 않게 해야 한다.`
      - 변화에 탄력적인 인터페이스를 만들 수 있는 능력은 `객체지향 설계자의 수준을 가늠하는 중요한 척도`다.
- 구현 관점
  - 구현 관점은 `클래스의 내부 구현을 바라본다.`
  - 클래스의 `메서드와 속성은 구현에 속하며 공용 인터페이스의 일부가 아니다.`
    - 따라서 `메서드의 구현과 속성의 변경은 원칙적으로 외부의 객체에게 영향을 미쳐서는 안된다.`
    - 이것은 `메서드와 속성이 철저하게 클래스 내부로 캡슐화돼야 한다는 것을 의미`한다.
    - `메서드와 속성은 클래스 내부의 비밀`이다.
  - 외부의 클래스는 자신이 협력하는 다른 클래스의 비밀 때문에 우왕좌왕해서는 안 된다.
- 개념 관점, 명세 관점, 구현 관점은 `동일한 코드를 바라보는 서로 다른 관점`이다.
  - 훌륭한 객체지향 프로그래머는 `하나의 클래스 안에 세 가지 관점을 모두 포함하면서도 각 관점에 대응되는 요소를 명확하고 깔끔하게 드러낼 수 있다.`

### 도메인 개념을 참조하는 이유
- 어떤 메시지가 있을 때 그 메시지를 수신할 객체를 선택하는 첫 번째 전략은 `도메인 개념 중에서 가장 적절한 것을 선택`하는 것이다.
  - 도메인 개념안에서 적절한 객체를 선택하는 것은 `도메인에 대한 지식을 기반으로 코드의 구조와 의미를 쉽게 유추`할 수 있게 한다.
- 소프트웨어는 항상 변한다.
  - 여러 개의 클래스로 기능을 분할하고 클래스 안에서 인터페이스와 구현을 분리하는 이유는 `변경이 발생했을 때 코드를 좀 더 수월하게 수정하길 간절히 원하기 때문`이다.
  - `소프트웨어 클래스가 도메인 개념을 따르면 변화에 쉽게 대응`할 수 있다.

### 인터페이스와 구현을 분리하라
- `인터페이스와 구현을 분리`하라.
- 명세 관점과 구현 관점이 뒤섞여 머릿속을 함부로 어지럽히지 못하게 하라.
  - 명세 관점은 `클래스의 안정적인 측면을 드러내야 한다.`
  - 구현 관점은 `클래스의 불안정한 측면을 드러내야 한다.`
  - `인터페이스가 구현 세부 사항을 노출하기 시작하면 아주 작은 변동에도 전체 협력이 요동치는 취약한 설계`를 얻을 수밖에 없다.
- 프로그래머의 입장에서 가장 많이 접하게 되는 것은 코드이므로 구현 관점을 가장 빈번하게 사용하겠지만 `실제로 훌륭한 설계를 결정하는 측면은 명세 관점인 객체의 인터페이스`다.
  - `명세 관점이 설계를 주도하게 하면 설계의 품질이 향상될 수 있다는 사실을 기억`하라.
- 중요한 것은 `클래스를 봤을 때 클래스를 명세 관점과 구현 관점으로 나눠볼 수 있어야 한다는 것`이다.
  - `캡슐화를 위반해서 구현을 인터페이스 밖으로 노출해서도 안 되고, 인터페이스와 구현을 명확하게 분리하지 않고 흐릿하게 섞어놓아서도 안 된다.`
  - `세 가지 관점 모두에서 클래스를 바라볼 수 있으려면 훌륭한 설계가 뒷밤침돼야 하는 것`이다.